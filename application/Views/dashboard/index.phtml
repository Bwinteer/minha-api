<!DOCTYPE html>
<html>
<head>
    <title>Teste da API</title>
</head>
<body>
    <h1>Teste da API</h1>
    
    <h2>Usuários</h2>
    <button onclick="listarUsuarios()">Listar Usuários</button>
    <button onclick="criarUsuario()">Criar Usuário</button>
    <button onclick="buscarUsuario()">Buscar Usuário ID 1</button>

    <h2>Projetos</h2>
    <button onclick="listarProjetos()">Listar Projetos</button>
    <button onclick="criarProjeto()">Criar Projeto</button>
    <button onclick="buscarProjeto()">Buscar Projeto ID 1</button>

    <h2>Tarefas</h2>
    <button onclick="listarTarefas()">Listar Tarefas</button>
    <button onclick="criarTarefa()">Criar Tarefa</button>
    <button onclick="buscarTarefa()">Buscar Tarefa ID 1</button>

    <div id="resultado" class="resultado">
        Resultado aparecerá aqui...
    </div>

    <script>
        function listarUsuarios() {
            fetch('/usuarios')
                .then(r => r.json())
                .then(d => mostrarResultado('Usuários', d));
        }

        function criarUsuario() {
            const dados = {
                nome: 'Cadu Winter',
                email: 'cadu22@api.com',
                telefone: '(11) 95555-5555'
            };

            fetch('/usuarios/criar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dados)
            })
            .then(r => r.json())
            .then(d => mostrarResultado('Usuário criado', d));
        }

        function buscarUsuario() {
            fetch('/usuarios/1')
                .then(r => r.json())
                .then(d => mostrarResultado('Usuário ID 1', d));
        }

        function listarProjetos() {
            fetch('/projetos')
                .then(r => r.json())
                .then(d => mostrarResultado('Lista de Projetos', d))
                .catch(e => mostrarErro('Erro ao listar projetos', e));
        }

        function criarProjeto() {
            const dados = {
                nome: 'Projeto Exemplo API',
                descricao: 'Projeto criado via API para teste',
            };

            fetch('/projetos/criar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dados)
            })
            .then(r => r.json())
            .then(d => mostrarResultado('Projeto criado', d))
            .catch(e => mostrarErro('Erro ao criar projeto', e));
        }

        function buscarProjeto() {
            fetch('/projetos/1')
                .then(r => r.json())
                .then(d => mostrarResultado('Projeto ID 1', d))
                .catch(e => mostrarErro('Erro ao buscar projeto', e));
        }

        function atualizarProjeto() {
            const dados = {
                nome: 'Projeto Atualizado',
                descricao: 'Descrição atualizada via API',
                data_inicio: '2025-08-01',
                data_fim: '2025-09-30'
            };

            fetch('/projetos/atualizar/1', {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dados)
            })
            .then(r => r.json())
            .then(d => mostrarResultado('Projeto atualizado', d))
            .catch(e => mostrarErro('Erro ao atualizar projeto', e));
        }

        function deletarProjeto() {
            if (confirm('Tem certeza que deseja deletar o projeto ID 1?')) {
                fetch('/projetos/delete/1', {
                    method: 'DELETE'
                })
                .then(r => r.json())
                .then(d => mostrarResultado('Projeto deletado', d))
                .catch(e => mostrarErro('Erro ao deletar projeto', e));
            }
        }

        function listarTarefas() {
            fetch('/tarefas')
                .then(r => r.json())
                .then(d => mostrarResultado('Tarefas', d));
        }

        function criarTarefa() {
            const dados = {
                titulo: 'Tarefa Teste',
                descricao: 'Descrição da tarefa',
                status: 'pendente',
                prioridade: 'alta',
                data_vencimento: '2025-08-10',
                projeto_id: 1,
                usuario_id: 1
            };

            fetch('/tarefas', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dados)
            })
            .then(r => r.json())
            .then(d => mostrarResultado('Tarefa criada', d));
        }

        function buscarTarefa() {
            fetch('/tarefas?id=1')
                .then(r => r.json())
                .then(d => mostrarResultado('Tarefa ID 1', d));
        }

        function mostrarResultado(titulo, dados) {
            const resultado = document.getElementById('resultado');
            resultado.innerHTML = `
                <h3>✅ ${titulo}</h3>
                <pre>${JSON.stringify(dados, null, 2)}</pre>
            `;
            resultado.style.borderLeftColor = '#28a745';
        }

        function mostrarErro(titulo, erro) {
            const resultado = document.getElementById('resultado');
            resultado.innerHTML = `
                <h3>❌ ${titulo}</h3>
                <pre style="color: #dc3545;">${erro.message || erro}</pre>
            `;
            resultado.style.borderLeftColor = '#dc3545';
            console.error(titulo, erro);
        }
    </script>
</body>
</html>
<style>
    body { font-family: Arial; margin: 20px; }
    button { padding: 10px; margin: 5px; cursor: pointer; }
    .resultado { background: #f0f0f0; padding: 10px; margin: 10px 0; }
</style>